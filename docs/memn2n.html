

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>End-to-End Memory Networks for Goal Oriented Dialogue &mdash; NLP Architect by Intel® AI Lab 0.4.post2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato" type="text/css" />
  <link rel="stylesheet" href="_static/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Language Modeling" href="tcn.html" />
    <link rel="prev" title="Reading Comprehension" href="reading_comprehension.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/nlp_architect_logo_white.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="main.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Jupyter Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="service.html">REST Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">Model Zoo</a></li>
</ul>
<p class="caption"><span class="caption-text">NLP/NLU Models</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="absa.html">Aspect Based Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chunker.html">Sequence Chunker</a></li>
<li class="toctree-l1"><a class="reference internal" href="ner_crf.html">Named Entity Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="intent.html">Intent Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="np_segmentation.html">Noun Phrase Semantic Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="bist_parser.html">BIST Dependency Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="word_sense.html">Most Common Word Sense</a></li>
<li class="toctree-l1"><a class="reference internal" href="np2vec.html">Noun Phrase to Vec</a></li>
<li class="toctree-l1"><a class="reference internal" href="supervised_sentiment.html">Supervised Sentiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading_comprehension.html">Reading Comprehension</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">End-to-End Memory Networks for Goal Oriented Dialogue</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#files">Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-modalities">Running Modalities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-mode">Interactive Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tcn.html">TCN Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="crosslingual_emb.html">Unsupervised Crosslingual Embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross_doc_coref.html">Cross Document Co-Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="identifying_semantic_relation.html">Semantic Relation Identification</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_gnmt.html">Sparse Neural Machine Translation</a></li>
</ul>
<p class="caption"><span class="caption-text">Solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="absa_solution.html">Aspect Based Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="term_set_expansion.html">Set Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="trend_analysis.html">Trend Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Pipelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spacy_bist.html">Spacy-BIST Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="spacy_np_annotator.html">Spacy-NP Annotator</a></li>
</ul>
<p class="caption"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NLP Architect by Intel® AI Lab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>End-to-End Memory Networks for Goal Oriented Dialogue</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="end-to-end-memory-networks-for-goal-oriented-dialogue">
<h1>End-to-End Memory Networks for Goal Oriented Dialogue<a class="headerlink" href="#end-to-end-memory-networks-for-goal-oriented-dialogue" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This directory contains an implementation of an End-to-End Memory Network for goal oriented dialogue in TensorFlow.</p>
<p>Goal oriented dialogue is a subset of open-domain dialogue where an automated agent has a specific
goal for the outcome of the interaction. At a high level, the system needs to understand a user
request and complete a related task with a clear goal within a limited number of dialog turns.
This task could be making a restaurant reservation, placing an order, setting a timer, or many of the digital personal assistant tasks.</p>
<p>End-to-End Memory Networks are generic semi-recurrent neural networks which allow for a bank of
external memories to be read from and used during execution. They can be used in place of traditional
slot-filling algorithms to accomplish goal oriented dialogue tasks without the need for expensive
hand-labeled dialogue data. End-to-End Memory Networks have also been shown to be useful for
Question-Answering and information retrieval tasks.</p>
<p><strong>End-to-End Memory Network</strong></p>
<img alt="n2n_memory_networks" src="https://camo.githubusercontent.com/ba1c7dbbccc5dd51d4a76cc6ef849bca65a9bf4d/687474703a2f2f692e696d6775722e636f6d2f6e7638394a4c632e706e67" />
<p><strong>Goal Oriented Dialog</strong></p>
<img alt="goal_oriented_dialog" src="https://i.imgur.com/5pQJqjM.png" />
</div>
<div class="section" id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>nlp_architect/data/babi_dialog.py</strong>: Data loader <a class="reference internal" href="generated/nlp_architect.data.babi_dialog.BABI_Dialog.html#nlp_architect.data.babi_dialog.BABI_Dialog" title="nlp_architect.data.babi_dialog.BABI_Dialog"><code class="xref py py-class docutils literal notranslate"><span class="pre">class</span></code></a> to download data if not present and perform preprocessing.</p></li>
<li><p><strong>nlp_architect/models/memn2n_dialogue.py</strong>: Implementation of <a class="reference internal" href="generated/nlp_architect.models.memn2n_dialogue.MemN2N_Dialog.html#nlp_architect.models.memn2n_dialogue.MemN2N_Dialog" title="nlp_architect.models.memn2n_dialogue.MemN2N_Dialog"><code class="xref py py-class docutils literal notranslate"><span class="pre">MemN2N_Dialog</span></code></a> class for dialogue tasks.</p></li>
<li><p><strong>examples/memn2n_dialog/train_model.py</strong>: Training script to load dataset and train memory network.</p></li>
<li><p><strong>examples/memn2n_dialog/interactive.py</strong>: Inference script to run interactive session with a trained goal oriented dialog agent.</p></li>
<li><p><strong>examples/memn2n_dialog/interactive_utils.py</strong>: Utilities to support interactive mode and simulate backend database.</p></li>
</ul>
</div>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h2>
<p>The dataset used for training and evaluation is under the umbrella of the Facebook bAbI dialog tasks
(<a class="reference external" href="https://research.fb.com/downloads/babi/">https://research.fb.com/downloads/babi/</a>, License: <a class="reference external" href="https://github.com/facebook/bAbI-tasks/blob/master/LICENSE.md">https://github.com/facebook/bAbI-tasks/blob/master/LICENSE.md</a>). The terms and conditions of the data set license apply. Intel does not grant any rights to the data files. The dataset is automatically downloaded if not found,
and the preprocessing all happens at the beginning of training.</p>
<p>There are six separate tasks, tasks 1 through 5 are from simulated conversations between a customer
and a restaurant booking bot (created by Facebook), and task 6 is more realistic natural language
restaurant booking conversations as part of the <a class="reference external" href="https://www.microsoft.com/en-us/research/event/dialog-state-tracking-challenge/">dialog state tracking challenge</a>.</p>
<p>The descriptions of the six tasks are as follow:</p>
<ul class="simple">
<li><dl class="simple">
<dt>bAbI dialog dataset:</dt><dd><ul>
<li><p>Task 1: Issuing API Calls</p></li>
<li><p>Task 2: Updating API Calls</p></li>
<li><p>Task 3: Displaying Options</p></li>
<li><p>Task 4: Providing Extra Information</p></li>
<li><p>Task 5: Conducting Full Dialogs</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Dialog State Tracking Challenge 2 Dataset:</dt><dd><ul>
<li><p>Task 6: DSTC2 Full Dialogs</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="running-modalities">
<h2>Running Modalities<a class="headerlink" href="#running-modalities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="training">
<h3>Training<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h3>
<p>To train the model without match type on full dialog tasks, the following command can be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">memn2n_dialog</span><span class="o">/</span><span class="n">train_model</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">task</span> <span class="mi">5</span> <span class="o">--</span><span class="n">weights_save_path</span> <span class="n">memn2n_weights</span><span class="o">.</span><span class="n">npz</span>
</pre></div>
</div>
<p>The flag <code class="docutils literal notranslate"><span class="pre">--use_match_type</span></code> can also be used to enable match type features (for improved out-of-vocab performance but slower training).</p>
</div>
<div class="section" id="interactive-mode">
<h3>Interactive Mode<a class="headerlink" href="#interactive-mode" title="Permalink to this headline">¶</a></h3>
<p>To begin interactive evaluation with a trained model, the following command can be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">memn2n_dialog</span><span class="o">/</span><span class="n">interactive</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">weights_save_path</span> <span class="n">memn2n_weights</span><span class="o">.</span><span class="n">npz</span>
</pre></div>
</div>
<p>Interactive evaluation begins at the end of training and works as an interactive shell.
Commands available for the shell are as follows:</p>
<ul class="simple">
<li><p>help: Display this help menu</p></li>
<li><p>exit / quit: Exit interactive mode</p></li>
<li><p>restart / clear: Restart the conversation and erase the bot’s memory</p></li>
<li><p>vocab: Display usable vocabulary</p></li>
<li><p>allow_oov: Allow out of vocab words to be replaced with &lt;OOV&gt; token</p></li>
<li><p>show_memory: Display the current contents of the bot’s memory</p></li>
<li><p>show_attention: Show the bot’s memory &amp; associated computed attention for the last memory hop</p></li>
</ul>
<p>Otherwise, the interactive mode operates as a chat bot, responding to dialog to assist with
restaurant booking. Vocabulary of the model is limited, please use the vocab command to see what the
model actually understands.</p>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The model was trained and evaluated on the 6 bAbI Dialog tasks with the following results.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task</p></th>
<th class="head"><p>This</p></th>
<th class="head"><p>Published</p></th>
<th class="head"><p>This (w/ match-type)</p></th>
<th class="head"><p>Published (w/ match-type)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>99.8</p></td>
<td><p>99.9</p></td>
<td><p>100.0</p></td>
<td><p>100.0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>100.0</p></td>
<td><p>100.0</p></td>
<td><p>100.0</p></td>
<td><p>98.3</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>74.8</p></td>
<td><p>74.9</p></td>
<td><p>74.6</p></td>
<td><p>74.9</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>57.2</p></td>
<td><p>59.5</p></td>
<td><p>100.0</p></td>
<td><p>100.0</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>96.4</p></td>
<td><p>96.1</p></td>
<td><p>95.6</p></td>
<td><p>93.4</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>48.1</p></td>
<td><p>41.1</p></td>
<td><p>45.4</p></td>
<td><p>41.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Paper</strong>: A. Bordes, Y. Boureau, J. Weston. <a class="reference external" href="https://arxiv.org/abs/1605.07683">Learning End-to-End Goal-Oriented Dialog</a> 2016</p></li>
<li><p><strong>Reference TF Implementation</strong>: <a class="reference external" href="https://github.com/vyraun/chatbot-MemN2N-tensorflow">chatbot-MemN2N-tensorflow</a> (no match-type or interactive mode)</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>